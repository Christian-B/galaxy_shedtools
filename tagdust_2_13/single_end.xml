<tool id="tagdust_single_end" name="Tagdust single ed processor" version="0.1">
    <description>Runs tagdust in single end mode</description>
    <requirements>
        <requirement type="package" version="2.13">tagdust</requirement>
    </requirements>
    <stdio>
        <exit_code range="1" level="fatal" description="Error code 1 occurred" />
        <exit_code range="2:255" level="fatal" description="Unknown error occurred" />
    </stdio>
    <command >
        cp $fastq_file input.fastq ;
        mkdir output ;
        tagdust -t8 -o output/data -1 F:NNNNNNNN -2 S:TATAGGG -3 R:N input.fastq ;
        ls -al output 
    </command>
    <inputs>
        <param name="fastq_file" type="data" format="fastq" label="Single Fastq file to process" />
    </inputs>
    <outputs>
        <data format="txt" name="logfile" label="The tagdust logoutput." from_work_dir="output/data_logfile.txt"/>
        <data format="fastq" name="extracted" label="The tagdust extracted reads." from_work_dir="output/data.fq"/>
        <data format="fastq" name="unextracted" label="The tagdust un-extracted reads." from_work_dir="output/data_un.fq"/>
    </outputs>
    <tests>
        <test>
            <param name="fastq_file" value="C75_S29_R1_001.fastq.gz" ftype="fastq" /> 
            <output name="logfile" >
                <assert_contents>
                    <has_text text="Tagdust 2.13" />
                 </assert_contents>
            </output>
            <output name="extracted" file="C75_S29_R1_001.fq" compare="sim_size" delta="10000"/>
            <output name="unextracted" file="C75_S29_R1_001_un.fq"  compare="sim_size" delta="10000"/>
        </test>
    </tests>
    <help>
<![CDATA[
    prints tagdust version
]]>
    </help>
    <citations>
    </citations>

</tool>
